<!DOCTYPE html>
<html>
  <head>
    <title>StockTradingApp</title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>
    <%= stylesheet_link_tag "tailwind", "inter-font", "data-turbo-track": "reload" %>
    <%= stylesheet_link_tag "application", "data-turbo-track": "reload" %>
    <script src="https://kit.fontawesome.com/4a45b90c57.js" crossorigin="anonymous"></script>
    <%= javascript_importmap_tags %>
    <style>
      .flash_message {
        opacity: 0;
        transition: opacity 0.3s ease-in-out;
      }

      .show {
        opacity: 1;
      }
    </style>
  </head>
  <% if current_page?(new_user_session_path) ||  current_page?(new_admin_user_session_path) || current_page?(new_user_registration_path) %>
    <section class="backgound__video">
      <video id="video" autoplay loop muted>
        <source src="<%= asset_path('bg-video.mp4') %>" type="video/mp4" />
        Your browser does not support the video tag.
      </video>
    </section>
  <%end%>
  <body class="bg-gray-50 dark:bg-gray-800">
    <% unless current_page?(new_user_session_path) || current_page?(new_admin_user_session_path) || current_page?(new_user_registration_path) %>
      <header class="w-full bg-white fixed top-0 left-0 shadow-[0_0_10px_rgba(0,0,0,0.15)] dark:shadow-[0_0_10px_rgba(0,0,0,0.80)]  z-50 dark:bg-gray-700 dark:text-gray-50">
        <nav class="flex items-center justify-between w-[clamp(300px,90%,1200px)] mx-auto font-bold text-lg">
          <ul class="flex">
            <li class = "py-4 px-6 <%=current_page?(root_path) ? 'bg-[#001F3F] text-white dark:bg-gray-600 dark:text-gray-100' : ''%>">
              <%= link_to 'News', root_path%>
            </li>
            <% if current_admin_user %>
              <li class = "py-4 px-6 <%= current_page?(admin_dashboard_index_path) ? 'bg-[#001F3F] text-white dark:bg-gray-600 dark:text-gray-100' : ''%>">
                <%= link_to 'Dashboard', admin_dashboard_index_path %>
              </li>
              <li class = "py-4 px-6 <%= current_page?(admin_trader_index_path) ? 'bg-[#001F3F] text-white dark:bg-gray-600 dark:text-gray-100' : '' %>">
                <%= link_to 'Accounts', admin_trader_index_path%>
              </li>
              <li class = "py-4 px-6 <%=current_page?(admin_transactions_path) ? 'bg-[#001F3F] text-white dark:bg-gray-600 dark:text-gray-100' : '' %>">
                <%= link_to 'Transactions', admin_transactions_path %>
              </li>
            <% else %>
              <li class = "py-4 px-6 <%= current_page?(trader_dashboard_index_path) ? 'bg-[#001F3F] text-white dark:bg-gray-600 dark:text-gray-100' : '' %>">
                <%= link_to 'Dashboard', trader_dashboard_index_path %>
              </li>
              <li class = "py-4 px-6 <%= current_page?(trader_portfolio_index_path) ? 'bg-[#001F3F] text-white dark:bg-gray-600 dark:text-gray-100' : '' %>">
                <%= link_to 'Portfolio', trader_portfolio_index_path  %>
              </li>
              <li class = "py-4 px-6 <%= current_page?(trader_transactions_path) ? 'bg-[#001F3F] text-white dark:bg-gray-600 dark:text-gray-100' : ''%>">
                <%= link_to 'Transaction History', trader_transactions_path %>
              </li>
            <% end %>
          </ul>
          <div class="flex items-center gap-4">
            <% if !user_signed_in? && !admin_user_signed_in? %>
              <%= link_to 'Sign In', new_user_session_path, class: '' %>
            <% else %>
              <% if current_user %>
                <%= link_to "Logout", destroy_user_session_path, data: {
                turbo_method: :delete,
                turbo_confirm: "Are you sure?"
              } %>
              <% elsif current_admin_user %>
                <%= link_to "Logout", destroy_admin_user_session_path, data: {
                turbo_method: :delete,
                turbo_confirm: "Are you sure?"
              } %>
              <% end %>
            <% end %>
            <button id="theme-toggle" class=""></button>
          </div>
        </nav>
      </header>
    <%end%>
    <div class="w-[clamp(300px,90%,1200px)] mx-auto min-h-screen grid place-items-center <%= if current_page?(new_user_session_path) || current_page?(new_admin_user_session_path) then '' else 'pt-20 pb-6' end %> relative z-100">
      <div class="absolute top-[100px] right-0 translate-x-0 translate-y-[-40%] w-[clamp(300px,90%,550px)] z-10">
        <% unless notice.blank? %>
          <div class="flex justify-between items-center bg-green-200 text-green-900 px-4 py-3 rounded-md flex-grow-1 w-full self-start show">
            <p class="notice"><%= notice %></p>
            <button type="button" class="close-button" onclick="this.parentNode.style.display = 'none';">×</button>
          </div>
        <% end %>
        <% unless alert.blank? %>
          <div class="flex justify-between items-center bg-red-200 text-red-900 px-4 py-3 rounded-md flex-grow-1 w-full self-start show">
            <p class="alert"><%= alert %></p>
            <button type="button" class="close-button" onclick="this.parentNode.style.display = 'none';">×</button>
          </div>
        <% end %>
      </div>
      <%= yield %>
    </div>
  </body>
</html>
